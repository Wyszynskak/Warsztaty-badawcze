p_val
sprintf("%s.mRNA",cancer_types[j])
sprintf("%s.clinical",cancer_types[j])
p
pchisq(p$chisq,1)
1-pchisq(p$chisq,1)
q
q<-sort(table(names(most_good)))
q
cancer_types<-c("BRCA","COAD","COADREAD","GBMLGG","KIPAN","KIRC","KIRP","LGG","LUAD","LUSC","OV","READ","UCEC")
most_good_cancer<-list()
for(cancer in cancer_types)
{
p<-readRDS(paste0("./",cancer,"/p-values.RDS"))
p<-sort(p)
p1<-p[1:100]
if(sum(names(p1)=='UBTF'))
print(cancer)
most_good_cancer[[which(cancer_types==cancer)]]<-p1
}
j<-5
p<-sprintf("%s.mRNA",cancer_types[j])
q<-sprintf("%s.clinical",cancer_types[j])
namep<-data(list=p)
nameq<-data(list=q)
mBRCA<-.GlobalEnv[[namep]]
cBRCA<-.GlobalEnv[[nameq]]
cBRCA <- data.frame(time1=as.numeric(as.character(cBRCA$patient.days_to_death)),
time2=as.numeric(as.character(cBRCA$patient.days_to_last_followup)),
status = cBRCA$patient.vital_status,
barcode = cBRCA$patient.bcr_patient_barcode,
race=cBRCA$patient.race,
therapy=cBRCA$patient.drugs.drug.therapy_types.therapy_type)
cBRCA$time <- ifelse(is.na(cBRCA$time1), cBRCA$time2, cBRCA$time1)
mBRCA$bcr_patient_barcode<-tolower(substr(mBRCA$bcr_patient_barcode, 1, 12))
allBRCA<-merge(mBRCA,cBRCA,by.x="bcr_patient_barcode",by.y="barcode")
statsy<-readRDS(paste0("./",'KIPAN',"/p-values.RDS"))
which(names(statsy)=='UBFT')
names(statsy)
title<-names(dat_min)[2]
dat_min<-allBRCA[,c(1,which(names(statsy)=='UBTF'),(ncol(mBRCA)+1):ncol(allBRCA))]
title<-names(dat_min)[2]
names(dat_min)[2]<-"val"
med<-median(na.omit(dat_min$val))
ob1 <- survfit(Surv(time, status == "dead")~(val>med), data=dat_min)
autoplot(ob1,title = title)
dat_min<-allBRCA[,c(1,(which(names(statsy)=='UBTF')+1),(ncol(mBRCA)+1):ncol(allBRCA))]
dat_min
title<-names(dat_min)[2]
names(dat_min)[2]<-"val"
med<-median(na.omit(dat_min$val))
ob1 <- survfit(Surv(time, status == "dead")~(val>med), data=dat_min)
autoplot(ob1,title = title)
dat_min<-allBRCA[,c(1,(which(names(statsy)=='CXorf52')+1),(ncol(mBRCA)+1):ncol(allBRCA))]
title<-names(dat_min)[2]
dat_min<-allBRCA[,c(1,(which(names(statsy)=='CXorf52')+1),(ncol(mBRCA)+1):ncol(allBRCA))]
dat_min
title<-names(dat_min)[2]
names(dat_min)[2]<-"val"
med<-median(na.omit(dat_min$val))
ob1 <- survfit(Surv(time, status == "dead")~(val>med), data=dat_min)
autoplot(ob1,title = title)
med
head(dat.min)
head(dat_min)
p<-sprintf("%s.mRNA",cancer_types[j])
namep<-data(list=p)
mBRCA<-.GlobalEnv[[namep]]
head(mBRCA)[1:4]
cancer_types<-c("BRCA","COAD","COADREAD","GBMLGG","KIPAN","KIRC","KIRP","LGG","LUAD","LUSC","OV","READ","UCEC")
most_good_cancer<-list()
for(cancer in cancer_types)
{
p<-readRDS(paste0("./",cancer,"/p-values.RDS"))
p<-sort(p,decreasing=FALSE)
p1<-p[1:100]
if(sum(names(p1)=='UBTF'))
print(cancer)
most_good_cancer[[which(cancer_types==cancer)]]<-p1
}
p<-readRDS(paste0("./",cancer,"/p-values.RDS"))
cancer_types<-c("BRCA","COAD","COADREAD","GBMLGG","KIPAN","KIRC","KIRP","LGG","LUAD","LUSC","OV","READ","UCEC")
most_good_cancer<-list()
for(cancer in cancer_types)
{
p<-readRDS(paste0("./",cancer,"/p-values.RDS"))
p<-sort(p,decreasing=TRUE)
p1<-p[1:100]
if(sum(names(p1)=='UBTF'))
print(cancer)
most_good_cancer[[which(cancer_types==cancer)]]<-p1
}
most_good<-most_good_cancer[[1]]
for(i in 2:length(cancer_types))
{
most_good<-c(most_good,most_good_cancer[[i]])
}
q<-sort(table(names(most_good)))
q
cancer_types<-c("BRCA","COAD","COADREAD","GBMLGG","KIPAN","KIRC","KIRP","LGG","LUAD","LUSC","OV","READ","UCEC")
most_good_cancer<-list()
for(cancer in cancer_types)
{
p<-readRDS(paste0("./",cancer,"/p-values.RDS"))
p<-sort(p,decreasing=TRUE)
p1<-p[1:100]
if(sum(names(p1)=='SNIP1'))
print(cancer)
most_good_cancer[[which(cancer_types==cancer)]]<-p1
}
statsy<-readRDS(paste0("./",'LGG',"/p-values.RDS"))
dat_min<-allBRCA[,c(1,(which(names(statsy)=='CXorf52')+1),(ncol(mBRCA)+1):ncol(allBRCA))]
title<-names(dat_min)[2]
names(dat_min)[2]<-"val"
med<-median(na.omit(dat_min$val))
ob1 <- survfit(Surv(time, status == "dead")~(val>med), data=dat_min)
autoplot(ob1,title = title)
statsy<-readRDS(paste0("./",'LGG',"/p-values.RDS"))
dat_min<-allBRCA[,c(1,(which(names(statsy)=='CXorf52')+1),(ncol(mBRCA)+1):ncol(allBRCA))]
title<-names(dat_min)[2]
names(dat_min)[2]<-"val"
med<-median(na.omit(dat_min$val))
ob1 <- survfit(Surv(time, status == "dead")~(val>med), data=dat_min)
autoplot(ob1,title = title)
statsy<-readRDS(paste0("./",'LGG',"/p-values.RDS"))
dat_min<-allBRCA[,c(1,(which(names(statsy)=='LGG')+1),(ncol(mBRCA)+1):ncol(allBRCA))]
title<-names(dat_min)[2]
names(dat_min)[2]<-"val"
med<-median(na.omit(dat_min$val))
ob1 <- survfit(Surv(time, status == "dead")~(val>med), data=dat_min)
autoplot(ob1,title = title)
allBRCA
statsy<-readRDS(paste0("./",'LGG',"/p-values.RDS"))
which(names(statsy)=='LGG')
dat_min<-allBRCA[,c(1,(which(names(statsy)=='SNIP1')+1),(ncol(mBRCA)+1):ncol(allBRCA))]
title<-names(dat_min)[2]
names(dat_min)[2]<-"val"
med<-median(na.omit(dat_min$val))
ob1 <- survfit(Surv(time, status == "dead")~(val>med), data=dat_min)
autoplot(ob1,title = title)
cancer_types<-c("BRCA","COAD","COADREAD","GBMLGG","KIPAN","KIRC","KIRP","LGG","LUAD","LUSC","OV","READ","UCEC")
most_good_cancer<-list()
for(cancer in cancer_types)
{
p<-readRDS(paste0("./",cancer,"/p-values.RDS"))
p<-sort(p,decreasing=TRUE)
p1<-p[1:100]
if(sum(names(p1)=='SNIP1'))
print(cancer)
most_good_cancer[[which(cancer_types==cancer)]]<-p1
}
statsy<-readRDS(paste0("./",'COAD',"/p-values.RDS"))
dat_min<-allBRCA[,c(1,(which(names(statsy)=='SNIP1')+1),(ncol(mBRCA)+1):ncol(allBRCA))]
title<-names(dat_min)[2]
names(dat_min)[2]<-"val"
med<-median(na.omit(dat_min$val))
ob1 <- survfit(Surv(time, status == "dead")~(val>med), data=dat_min)
autoplot(ob1,title = title)
p<-sprintf("%s.mRNA",cancer_types[7])
j<-7
p<-sprintf("%s.mRNA",cancer_types[j])
q<-sprintf("%s.clinical",cancer_types[j])
namep<-data(list=p)
nameq<-data(list=q)
<-.GlobalEnv[[namep]]
cBRCA<-.GlobalEnv[[nameq]]
cBRCA <- data.frame(time1=as.numeric(as.character(cBRCA$patient.days_to_death)),
time2=as.numeric(as.character(cBRCA$patient.days_to_last_followup)),
status = cBRCA$patient.vital_status,
barcode = cBRCA$patient.bcr_patient_barcode,
race=cBRCA$patient.race,
therapy=cBRCA$patient.drugs.drug.therapy_types.therapy_type)
cBRCA$time <- ifelse(is.na(cBRCA$time1), cBRCA$time2, cBRCA$time1)
mBRCA$bcr_patient_barcode<-tolower(substr(mBRCA$bcr_patient_barcode, 1, 12))
allBRCA<-merge(mBRCA,cBRCA,by.x="bcr_patient_barcode",by.y="barcode")
p<-sprintf("%s.mRNA",cancer_types[j])
q<-sprintf("%s.clinical",cancer_types[j])
namep<-data(list=p)
nameq<-data(list=q)
mBRCA<-.GlobalEnv[[namep]]
cBRCA<-.GlobalEnv[[nameq]]
cBRCA <- data.frame(time1=as.numeric(as.character(cBRCA$patient.days_to_death)),
time2=as.numeric(as.character(cBRCA$patient.days_to_last_followup)),
status = cBRCA$patient.vital_status,
barcode = cBRCA$patient.bcr_patient_barcode,
race=cBRCA$patient.race,
therapy=cBRCA$patient.drugs.drug.therapy_types.therapy_type)
cBRCA$time <- ifelse(is.na(cBRCA$time1), cBRCA$time2, cBRCA$time1)
mBRCA$bcr_patient_barcode<-tolower(substr(mBRCA$bcr_patient_barcode, 1, 12))
allBRCA<-merge(mBRCA,cBRCA,by.x="bcr_patient_barcode",by.y="barcode")
statsy<-readRDS(paste0("./",'COAD',"/p-values.RDS"))
dat_min<-allBRCA[,c(1,(which(names(statsy)=='SNIP1')+1),(ncol(mBRCA)+1):ncol(allBRCA))]
title<-names(dat_min)[2]
names(dat_min)[2]<-"val"
med<-median(na.omit(dat_min$val))
ob1 <- survfit(Surv(time, status == "dead")~(val>med), data=dat_min)
autoplot(ob1,title = title)
ancer_types<-c("BRCA","COAD","COADREAD","GBMLGG","KIPAN","KIRC","KIRP","LGG","LUAD","LUSC","OV","READ","UCEC")
most_good_cancer<-list()
for(cancer in cancer_types)
{
p<-readRDS(paste0("./",cancer,"/p-values.RDS"))
p<-sort(p,decreasing=TRUE)
p1<-p[1:100]
if(sum(names(p1)=='SNIP1'))
print(cancer)
most_good_cancer[[which(cancer_types==cancer)]]<-p1
}
ancer_types<-c("BRCA","COAD","COADREAD","GBMLGG","KIPAN","KIRC","KIRP","LGG","LUAD","LUSC","OV","READ","UCEC")
most_good_cancer<-list()
for(cancer in cancer_types)
{
p<-readRDS(paste0("./",cancer,"/p-values.RDS"))
p<-sort(p,decreasing=TRUE)
p1<-p[1:100]
if(sum(names(p1)=='SNIP1'))
print(cancer)
most_good_cancer[[which(cancer_types==cancer)]]<-p1
}
j<-2
p<-sprintf("%s.mRNA",cancer_types[j])
q<-sprintf("%s.clinical",cancer_types[j])
namep<-data(list=p)
nameq<-data(list=q)
mBRCA<-.GlobalEnv[[namep]]
cBRCA<-.GlobalEnv[[nameq]]
cBRCA <- data.frame(time1=as.numeric(as.character(cBRCA$patient.days_to_death)),
time2=as.numeric(as.character(cBRCA$patient.days_to_last_followup)),
status = cBRCA$patient.vital_status,
barcode = cBRCA$patient.bcr_patient_barcode,
race=cBRCA$patient.race,
therapy=cBRCA$patient.drugs.drug.therapy_types.therapy_type)
cBRCA$time <- ifelse(is.na(cBRCA$time1), cBRCA$time2, cBRCA$time1)
mBRCA$bcr_patient_barcode<-tolower(substr(mBRCA$bcr_patient_barcode, 1, 12))
allBRCA<-merge(mBRCA,cBRCA,by.x="bcr_patient_barcode",by.y="barcode")
dat_min<-allBRCA[,c(1,(which(names(statsy)=='SNIP1')+1),(ncol(mBRCA)+1):ncol(allBRCA))]
title<-names(dat_min)[2]
names(dat_min)[2]<-"val"
med<-median(na.omit(dat_min$val))
ob1 <- survfit(Surv(time, status == "dead")~(val>med), data=dat_min)
autoplot(ob1,title = title)
j<-4
p<-sprintf("%s.mRNA",cancer_types[j])
q<-sprintf("%s.clinical",cancer_types[j])
namep<-data(list=p)
nameq<-data(list=q)
mBRCA<-.GlobalEnv[[namep]]
cBRCA<-.GlobalEnv[[nameq]]
cBRCA <- data.frame(time1=as.numeric(as.character(cBRCA$patient.days_to_death)),
time2=as.numeric(as.character(cBRCA$patient.days_to_last_followup)),
status = cBRCA$patient.vital_status,
barcode = cBRCA$patient.bcr_patient_barcode,
race=cBRCA$patient.race,
therapy=cBRCA$patient.drugs.drug.therapy_types.therapy_type)
cBRCA$time <- ifelse(is.na(cBRCA$time1), cBRCA$time2, cBRCA$time1)
mBRCA$bcr_patient_barcode<-tolower(substr(mBRCA$bcr_patient_barcode, 1, 12))
allBRCA<-merge(mBRCA,cBRCA,by.x="bcr_patient_barcode",by.y="barcode")
ncol(allBRCA)
dat_min<-allBRCA[,c(1,(which(names(statsy)=='SNIP1')+1),(ncol(mBRCA)+1):ncol(allBRCA))]
title<-names(dat_min)[2]
names(dat_min)[2]<-"val"
med<-median(na.omit(dat_min$val))
ob1 <- survfit(Surv(time, status == "dead")~(val>med), data=dat_min)
autoplot(ob1,title = title)
library(ggplot2)
library(survMisc)
library(RTCGA.mRNA)
library(RTCGA.clinical)
cancer_types<-c("BRCA")
mBRCA<-.GlobalEnv[[namep]]
cBRCA<-.GlobalEnv[[nameq]]
cBRCA <- data.frame(time1=as.numeric(as.character(cBRCA$patient.days_to_death)),
time2=as.numeric(as.character(cBRCA$patient.days_to_last_followup)),
status = cBRCA$patient.vital_status,
barcode = cBRCA$patient.bcr_patient_barcode,
race=cBRCA$patient.race,
therapy=cBRCA$patient.drugs.drug.therapy_types.therapy_type)
cBRCA$time <- ifelse(is.na(cBRCA$time1), cBRCA$time2, cBRCA$time1)
mBRCA$bcr_patient_barcode<-tolower(substr(mBRCA$bcr_patient_barcode, 1, 12))
allBRCA<-merge(mBRCA,cBRCA,by.x="bcr_patient_barcode",by.y="barcode")
nrow(allBRCA)
cancer_types<-c("BRCA")
p<-sprintf("%s.mRNA",cancer_types[1])
q<-sprintf("%s.clinical",cancer_types[1])
namep<-data(list=p)
nameq<-data(list=q)
mBRCA<-.GlobalEnv[[namep]]
cBRCA<-.GlobalEnv[[nameq]]
cBRCA <- data.frame(time1=as.numeric(as.character(cBRCA$patient.days_to_death)),
time2=as.numeric(as.character(cBRCA$patient.days_to_last_followup)),
status = cBRCA$patient.vital_status,
barcode = cBRCA$patient.bcr_patient_barcode,
race=cBRCA$patient.race,
therapy=cBRCA$patient.drugs.drug.therapy_types.therapy_type)
cBRCA$time <- ifelse(is.na(cBRCA$time1), cBRCA$time2, cBRCA$time1)
mBRCA$bcr_patient_barcode<-tolower(substr(mBRCA$bcr_patient_barcode, 1, 12))
allBRCA<-merge(mBRCA,cBRCA,by.x="bcr_patient_barcode",by.y="barcode")
nrow(allBRCA)
allBRCA[,2]
values<-allBRCA[,2]
values<-data.frame(allBRCA[,2])
values
values<-data.frame(val=allBRCA[,2])
head(values)
ggplot(values,aes(x=val))+geom_histogram()
ggplot(values,aes(x=val))+geom_histogram(binwidth=0.1)
allBRCA[,2]
names(allBRCA)
names(allBRCA)[2]
values<-data.frame(wartosci_mRNA_ELMO2=allBRCA[,2])
ggplot(values,aes(x=wartosci_mRNA_ELMO2))+geom_histogram(binwidth=0.1)
ggplot(values,aes(x=wartosci_mRNA_ELMO2))+geom_histogram(binwidth=0.1)+theme(axis.ticks = element_blank(), axis.text.y = element_blank())
element_blank()
ggplot(values,aes(x=wartosci_mRNA_ELMO2))+geom_histogram(binwidth=0.1)+theme(axis.ticks = element_blank(), axis.text.y = 'ile')
ggplot(values,aes(x=wartosci_mRNA_ELMO2))+geom_histogram(binwidth=0.1)+theme(axis.ticks = element_blank(), axis.text.y = "ile")
library(tidyr
)
install.packages("tidyr")
library(tidyr)
cBRCA
nameS(mBRCA)[1]
names(mBRCA)[1]
?spread
gather
?gather
mBRCA_small<0mBRCA[,1:4]
mBRCA_small<-mBRCA[,1:4]
?gather
mBRCA_small<-mBRCA[,2:5]
gather(mBRCA_small,key=names(mBRCA))
gather(mBRCA_small,key=names(mBRCA_small))
mBRCA_small<-mBRCA[,1:5]
names(mBRCA)[1]
gather(mBRCA_small,marker,val,-bcr_patient_barcode)
mBRCA_small<-gather(mBRCA_small,marker,val,-bcr_patient_barcode)
ggplot(values,aes(x=val,fill=marker))+geom_histogram(binwidth=0.1)
ggplot(mBRCA_small,aes(x=val,fill=marker))+geom_histogram(binwidth=0.1)
ggplot(mBRCA_small,aes(x=val))+geom_histogram(binwidth=0.1)+ facet_grid(. ~ marker)
ggplot(mBRCA_small,aes(x=val))+geom_histogram(binwidth=0.1)+ geom_density()+ facet_grid(. ~ marker)
ggplot(mBRCA_small,aes(x=val))+ geom_density()+ facet_grid(. ~ marker)
ggplot(mBRCA_small,aes(x=val))+geom_histogram(binwidth=0.1)+ geom_density()+ facet_grid(. ~ marker)
ggplot(mBRCA_small,aes(y= ..density..))+geom_histogram(binwidth=0.1)+ geom_density()+ facet_grid(. ~ marker)
cancer_types<-c("BRCA","OV","KIRP","KIRC")
namep<-data(list=p)
mBRCA<-.GlobalEnv[[namep]]
val<-mBRCA[,2]
elmo2<-data.frame(typ_raka=cancer_types[1],val=val)
elmo2
for (j in 2:length(cancer_types))
{
p<-sprintf("%s.mRNA",cancer_types[j])
namep<-data(list=p)
mBRCA<-.GlobalEnv[[namep]]
val<-mBRCA[,2]
elmo2_bis<-data.frame(typ_raka=cancer_types[j],val=val)
elmo2<-rbind(elmo2,elmo2_bis)
}
elmo2
ggplot(elmo2,aes(x=val))+geom_histogram(binwidth=0.1)+ facet_grid(. ~ typ_raka)
ggplot(elmo2,aes(x=val))+geom_density+ facet_grid(. ~ typ_raka)
ggplot(elmo2,aes(x=val))+geom_density()+ facet_grid(. ~ typ_raka)
cancer_types<-c("BRCA","OV")
p<-sprintf("%s.mRNA",cancer_types[1])
namep<-data(list=p)
mBRCA<-.GlobalEnv[[namep]]
val<-mBRCA[,2]
elmo2<-data.frame(typ_raka=cancer_types[1],val=val)
for (j in 2:length(cancer_types))
{
p<-sprintf("%s.mRNA",cancer_types[j])
namep<-data(list=p)
mBRCA<-.GlobalEnv[[namep]]
val<-mBRCA[,2]
elmo2_bis<-data.frame(typ_raka=cancer_types[j],val=val)
}
elmo2<-rbind(elmo2,elmo2_bis)
ggplot(elmo2,aes(x=val))+geom_histogram(binwidth=0.1)+ facet_grid(. ~ typ_raka)
ggplot(elmo2,aes(x=val,colour=typ_raka))+geom_density()
ggplot(elmo2,aes(x=val))+geom_histogram(binwidth=0.1)+ facet_grid(. ~ typ_raka)
ggplot(elmo2,aes(x=val,colour=typ_raka)) +stat_ecdf()
ggplot(elmo2,aes(x=val,colour=typ_raka))+geom_vline() +stat_ecdf()
ggplot(elmo2,aes(x=val,colour=typ_raka))+geom_vline(stat = median) +stat_ecdf()
ggplot(elmo2,aes(x=val,colour=typ_raka))+geom_vline(stat = median) +stat_ecdf()
ggplot(elmo2,aes(x=val,colour=typ_raka))+geom_vline(stat = "median") +stat_ecdf()
ggplot(elmo2,aes(x=val,colour=typ_raka))+geom_vline(aes(xintercept = median(x))) +stat_ecdf()
ggplot(elmo2,aes(x=val,colour=typ_raka))+geom_vline(aes(xintercept = median(val))) +stat_ecdf()
ggplot(elmo2,aes(x=val,colour=typ_raka))+geom_vline(aes(xintercept = median(val),colour=typ_raka)) +stat_ecdf()
ggplot(elmo2,aes(x=val,colour=typ_raka))+geom_vline(aes(xintercept = median(val),fill=typ_raka)) +stat_ecdf()
ggplot(elmo2,aes(x=val,colour=typ_raka))+geom_vline(aes(xintercept = median(val[typ_raka==1]), color=typ_raka[typ_raka==1]))),fill=typ_raka)) +stat_ecdf()
ggplot(elmo2,aes(x=val,colour=typ_raka))+geom_vline(aes(xintercept = median(val[typ_raka==1]), color=typ_raka[typ_raka==1])) +stat_ecdf()
ggplot(elmo2,aes(x=val,colour=typ_raka))+geom_vline(aes(xintercept = median(val[typ_raka=="OV"]), color=typ_raka[typ_raka=="OV"])) +stat_ecdf()
(val[typ_raka=="OV"]
library(ggplot2)
library(survMisc)
library(RTCGA.mRNA)
library(RTCGA.clinical)
cancer_types<-c("BRCA","COAD","COADREAD","GBMLGG","KIPAN","KIRC","KIRP","LGG","LUAD","LUSC","OV","READ","UCEC")
j<-1
p<-sprintf("%s.mRNA",cancer_types[j])
q<-sprintf("%s.clinical",cancer_types[j])
p
namep<-data(list=p)
nameq<-data(list=q)
mBRCA<-.GlobalEnv[[namep]]
cBRCA<-.GlobalEnv[[nameq]]
cBRCA <- data.frame(time1=as.numeric(as.character(cBRCA$patient.days_to_death)),
time2=as.numeric(as.character(cBRCA$patient.days_to_last_followup)),
status = cBRCA$patient.vital_status,
barcode = cBRCA$patient.bcr_patient_barcode,
race=cBRCA$patient.race,
therapy=cBRCA$patient.drugs.drug.therapy_types.therapy_type)
cBRCA$time <- ifelse(is.na(cBRCA$time1), cBRCA$time2, cBRCA$time1)
mBRCA$bcr_patient_barcode<-tolower(substr(mBRCA$bcr_patient_barcode, 1, 12))
allBRCA<-merge(mBRCA,cBRCA,by.x="bcr_patient_barcode",by.y="barcode")
length_gen<-length(2:ncol(mBRCA))
histy<-list()
survy<-list()
geny<-c()
i<-2
tylko_jeden_gen <- allBRCA[,c(1,i,(ncol(mBRCA)+1):ncol(allBRCA))]
geny[i-1]<- paste0(cancer_types[j],"_",names(tylko_jeden_gen)[2])
geny
names(tylko_jeden_gen)[2]<-"val"
med<-median(na.omit(tylko_jeden_gen$val))
p<-survfit(Surv(time, status == "dead")~(val>med), data=tylko_jeden_gen)
survy[[i-1]]<-p
q <- tylko_jeden_gen$val
q
tylko_jeden_gen
q+ geom_histogram(binwidth = 0.1)
ggplot(q)
ggplot(q)+ geom_histogram(binwidth = 0.1)
ggplot(data.frame(q))+ geom_histogram(binwidth = 0.1)
q <- tylko_jeden_gen
q
ggplot(q,aes(val))+ geom_histogram(binwidth = 0.1)
q <- data.frame(tylko_jeden_gen$val)
ggplot(q,aes(val))+ geom_histogram(binwidth = 0.1)
q
tylko_jeden_gen[,val]
tylko_jeden_gen[,'val']
tylko_jeden_gen[,2]
tylko_jeden_gen[,'val',drop=FALSE]
q <- tylko_jeden_gen[,'val',drop=FALSE]
q<-readRDS(paste0("../",cancer_types[j],"/histy.RDS"))[[i]]
q <- tylko_jeden_gen[,'val',drop=FALSE]
ggplot(q,aes(val))+ geom_histogram(binwidth = 0.1)
ggplot(q,aes(val))+ geom_histogram(binwidth = 0.1)
names(tylko_jeden_gen)[2]
tylko_jeden_gen <- allBRCA[,c(1,i,(ncol(mBRCA)+1):ncol(allBRCA))]
names(tylko_jeden_gen)[2]
library(ggplot2)
library(survMisc)
library(RTCGA.mRNA)
library(RTCGA.clinical)
cancer_types<-c("BRCA","COAD","COADREAD","GBMLGG","KIPAN","KIRC","KIRP","LGG","LUAD","LUSC","OV","READ","UCEC")
for (j in 1:length(cancer_types))
{
p<-sprintf("%s.mRNA",cancer_types[j])
q<-sprintf("%s.clinical",cancer_types[j])
namep<-data(list=p)
nameq<-data(list=q)
mBRCA<-.GlobalEnv[[namep]]
cBRCA<-.GlobalEnv[[nameq]]
cBRCA <- data.frame(time1=as.numeric(as.character(cBRCA$patient.days_to_death)),
time2=as.numeric(as.character(cBRCA$patient.days_to_last_followup)),
status = cBRCA$patient.vital_status,
barcode = cBRCA$patient.bcr_patient_barcode,
race=cBRCA$patient.race,
therapy=cBRCA$patient.drugs.drug.therapy_types.therapy_type)
cBRCA$time <- ifelse(is.na(cBRCA$time1), cBRCA$time2, cBRCA$time1)
mBRCA$bcr_patient_barcode<-tolower(substr(mBRCA$bcr_patient_barcode, 1, 12))
allBRCA<-merge(mBRCA,cBRCA,by.x="bcr_patient_barcode",by.y="barcode")
length_gen<-length(2:ncol(mBRCA))
histy<-list()
survy<-list()
geny<-c()
for(i in 2:ncol(mBRCA))
{
tylko_jeden_gen <- allBRCA[,c(1,i,(ncol(mBRCA)+1):ncol(allBRCA))]
geny[i-1]<- names(tylko_jeden_gen)[2]
names(tylko_jeden_gen)[2]<-"val"
med<-median(na.omit(tylko_jeden_gen$val))
tryCatch({
p<-survfit(Surv(time, status == "dead")~(val>med), data=tylko_jeden_gen)
survy[[i-1]]<-p
},
error = function(e) {
print(paste0("zlo_surv",i))
})
tryCatch({
q <- tylko_jeden_gen[,'val',drop=FALSE]
histy[[i-1]]<-q
},
error = function(e) {
print(paste0("zlo_hist",i))
})
if(i/1000==round(i/1000))
{
print(paste(j,i))
}
}
if(!(dir.exists(paste0("./",cancer_types[j]))))
{
dir.create(paste0("./",cancer_types[j]))
}
saveRDS(geny,paste0("./",cancer_types[j],"/geny.RDS"))
saveRDS(survy,paste0("./",cancer_types[j],"/survy.RDS"))
saveRDS(histy,paste0("./",cancer_types[j],"/histy.RDS"))
}
shiny::runApp('shiny')
shiny::runApp('shiny')
